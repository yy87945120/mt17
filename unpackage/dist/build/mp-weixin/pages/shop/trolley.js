(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/shop/trolley"],{"0301":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=function(){return n.e("components/counter/counter").then(n.bind(null,"84bc"))},l=function(){return n.e("components/uni-popup/uni-popup").then(n.bind(null,"3946"))},s={components:{counter:o,uniPopup:l},data:function(){return{title:"Hello",num17:20,trolley:[],popupData:"",skuId:0,total:0,num:0,count:0,tip:!1,selectAllFlag:0,count1:0}},onLoad:function(){this.getTrolley()},methods:{delete1:function(e){var n=this;if(0==n.num)return t.showToast({title:"你未勾选任何商品",icon:"none"}),!1;t.showModal({title:"删除操作",content:"亲，确认要删除勾选的商品？",success:function(e){if(e.confirm){var o=1,l=n.num;console.log(l),n.trolley.map(function(e){1==e.selectFlag&&n.$ajax("/cart/remove","POST",{skuId:e.skuId}).then(function(e){e?o==l&&n.getTrolley():(t.showToast({title:"商品删除错误",icon:"none"}),o==l&&n.getTrolley()),o++})})}}})},deleteProduct:function(t){},detail:function(e){t.navigateTo({url:"/pages/shop/detail?id="+e.sku.product.id})},chooseAll:function(){var e=this;1==this.selectAllFlag?this.$ajax("/cart/unselectAll","POST",{}).then(function(n){if(!n)return t.showToast({title:"无法取消全选，请再尝试",icon:"none"}),!1;e.selectAllFlag=0,e.trolley.map(function(t,n){e.trolley[n].selectFlag=e.selectAllFlag})}):this.$ajax("/cart/selectAll","POST",{}).then(function(n){if(!n)return t.showToast({title:"无法全选，请再尝试",icon:"none"}),!1;e.selectAllFlag=1,e.trolley.map(function(t,n){e.trolley[n].selectFlag=e.selectAllFlag})})},selectOne:function(e,n){var o=this;0==e.selectFlag?this.$ajax("/cart/select","POST",{skuId:e.skuId}).then(function(e){return e?(o.trolley[n].selectFlag=1,!1):(t.showToast({title:"无法选中，请再尝试",icon:"none"}),!1)}):this.$ajax("/cart/unselect","POST",{skuId:e.skuId}).then(function(e){return e?(o.trolley[n].selectFlag=0,!1):(t.showToast({title:"无法取消，请再尝试",icon:"none"}),!1)})},cal:function(e,n,o){var l=this;e<n.count?this.$ajax("/cart/add","POST",{skuId:n.skuId,count:-1}).then(function(s){"success"==s.msg?(t.showToast({title:"修改成功",icon:"none"}),l.trolley[o].count=e):(t.showToast({title:"添加失败",icon:"none"}),l.$refs.counter.plus(n.count))}):this.$ajax("/cart/add","POST",{skuId:n.skuId,count:1}).then(function(s){"success"==s.msg?(t.showToast({title:"修改成功",icon:"none"}),l.trolley[o].count=e):(t.showToast({title:"添加失败",icon:"none"}),l.$refs.counter.plus(n.count))})},guige:function(t,e){console.log(e),this.popupData=[],this.skuId=0,this.popupData=this.trolley[e],this.skuId=e,console.log(this.popupData)},bill17:function(){var e=this;this.$ajax("/useraddress/page","POST",{pageNo:1,pageSize:10,orderName:"default_flag",orderType:"desc"}).then(function(n){if(0==n.list.length)return t.showModal({title:"设置地址",content:"你还没有设置地址，请先设置默认地址",success:function(e){e.confirm&&t.navigateTo({url:"/pages/mine/address?bill=true"})}}),!1;0==e.count1?t.showToast({title:"您还未勾选任何商品",icon:"none"}):t.navigateTo({url:"/pages/shop/settlement"})})},getTrolley:function(){var e=this;this.$ajax("/cart/getCart","POST",{}).then(function(n){"查询出错"!=n?(t.showToast({title:"加载成功",icon:"none"}),e.selectAllFlag=n.selectAllFlag,e.trolley=[],n.cartItems.map(function(t){e.trolley.push(t)}),console.log(e.trolley.length)):t.showToast({title:"加载失败",icon:"none"})})}},watch:{trolley:{handler:function(t,e){var n=this;if(n.trolley){n.tip=!1,n.num=0,n.total=0,n.count=0,n.count1=0;var o=1;n.trolley.map(function(t,e){0==n.trolley[e].selectFlag?n.selectAllFlag=0:(o==n.trolley.length&&(n.selectAllFlag=1),n.count1=n.count1+1,o++),n.trolley[e].size||n.$set(n.trolley[e],"size",""),"string"==typeof n.trolley[e].sku.specificationValues&&(n.trolley[e].sku.specificationValues=JSON.parse(n.trolley[e].sku.specificationValues),t.sku.specificationValues.map(function(t,o){n.trolley[e].sku.specificationValues[o].value&&(n.trolley[e].size=n.trolley[e].size+" "+n.trolley[e].sku.specificationValues[o].value)})),1==t.selectFlag&&(n.num=n.num+1,n.count=n.count+t.count,n.total=n.total+t.sku.price/100*t.count)})}else n.tip=!0},immediate:!0,deep:!0}}};e.default=s}).call(this,n("543d")["default"])},"1b81":function(t,e,n){"use strict";(function(t){n("7b40"),n("921b");o(n("66fd"));var e=o(n("cb43"));function o(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},"322b":function(t,e,n){"use strict";n.r(e);var o=n("0301"),l=n.n(o);for(var s in o)"default"!==s&&function(t){n.d(e,t,function(){return o[t]})}(s);e["default"]=l.a},"3bfc":function(t,e,n){},"8eda":function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=(t._self._c,t.total.toFixed(2));t.$mp.data=Object.assign({},{$root:{g0:n}})},l=[];n.d(e,"a",function(){return o}),n.d(e,"b",function(){return l})},cb43:function(t,e,n){"use strict";n.r(e);var o=n("8eda"),l=n("322b");for(var s in l)"default"!==s&&function(t){n.d(e,t,function(){return l[t]})}(s);n("eeb2");var c=n("2877"),u=Object(c["a"])(l["default"],o["a"],o["b"],!1,null,null,null);e["default"]=u.exports},eeb2:function(t,e,n){"use strict";var o=n("3bfc"),l=n.n(o);l.a}},[["1b81","common/runtime","common/vendor"]]]);